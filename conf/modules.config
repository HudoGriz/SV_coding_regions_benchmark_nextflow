/*
========================================================================================
    Module configuration
========================================================================================
    This file configures process-specific settings and overrides.
    Container specs are inherited from nf-core modules unless overridden here.
========================================================================================
*/

process {
    // Manta WES: Add --exome flag for proper WES analysis
    withName: 'MANTA_WES' {
        ext.args = '--exome'  // Turn off depth filters for WES data
    }
    
    // Truvari: Custom args and output directory structure
    withName: 'TRUVARI_BENCH' {
        ext.args = { "--passonly --dup-to-ins ${meta.truvari_args ?: ''}" }
        ext.prefix = { "${meta.technology}_${meta.tool}_${meta.target}" }
        publishDir = [
            path: { "${params.outdir}/real_intervals/${meta.technology}/truvari/${meta.tool}/${meta.target}" },
            mode: 'copy',
            saveAs: { filename -> filename.equals('versions.yml') ? null : filename }
        ]
    }
    
    // BGZIP_TABIX: Specify VCF format for tabix
    withName: 'BGZIP_TABIX.*' {
        ext.args2 = '-p vcf'
    }
    
    // Custom R-based processes (not in nf-core)
    withName: 'SIMULATE_TARGETS|GATHER_STATISTICS|CREATE_.*' {
        container = 'rocker/tidyverse:4.4.1'
    }
}
