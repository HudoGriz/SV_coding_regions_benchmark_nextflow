/*
========================================================================================
    Nextflow config file for running tests using nf-core test data
========================================================================================
    Defines input files from nf-core/test-datasets repository for automated testing
----------------------------------------------------------------------------------------
*/

params {
    // Test configuration metadata
    config_profile_name        = 'nf-core test data profile'
    config_profile_description = 'Comprehensive test dataset using nf-core/test-datasets for all sequencing technologies'

    // Limit resources for testing
    max_cpus   = 2
    max_memory = '6.GB'
    max_time   = '6.h'

    // Base URL for nf-core test-datasets (modules branch)
    test_data_base = 'https://raw.githubusercontent.com/nf-core/test-datasets/modules/data'

    // Reference genome - chr22 subset (40kb region) that matches test BAM files
    // NOTE: Remote files will be downloaded by Nextflow automatically
    fasta = "${test_data_base}/genomics/homo_sapiens/genome/genome.fasta"

    // Input BAM files - using test BAM files that correctly match genome.fasta (chr22 LN:40001)
    // These are small paired-end test files with chr22 reads only
    illumina_wes_bam = "${test_data_base}/genomics/homo_sapiens/illumina/bam/test.paired_end.sorted.bam"
    illumina_wgs_bam = "${test_data_base}/genomics/homo_sapiens/illumina/bam/test2.paired_end.sorted.bam"
    
    // Long-read technologies - now included in comprehensive test
    pacbio_bam = "${test_data_base}/genomics/homo_sapiens/pacbio/bam/test.sorted.bam"
    ont_bam = "${test_data_base}/genomics/homo_sapiens/nanopore/bam/test.sorted.bam"

    // Skip benchmarking in test profile - no compatible SV truth set available
    // The test.genome.vcf.gz contains SNVs/indels, not SVs, and has multi-allelic records
    // which are incompatible with Truvari bench
    benchmark_vcf = null
    skip_benchmarking = true
    
    // Skip PBSV in test profile - test.sorted.bam doesn't have proper PacBio read group headers
    // PBSV requires specific PacBio BAM format with read group IDs that the test data lacks
    // CuteSV is more flexible and will still test PacBio SV calling functionality
    skip_pbsv = true

    // Target BED files - using minimal test regions
    high_confidence_targets = "${test_data_base}/genomics/homo_sapiens/genome/genome.bed"
    gene_panel_targets = "${test_data_base}/genomics/homo_sapiens/genome/genome.bed"
    wes_utr_targets = "${test_data_base}/genomics/homo_sapiens/genome/genome.bed"

    // Optional files - using genome.bed as placeholder for tandem repeats (for Sniffles)
    tandem_repeats = "${test_data_base}/genomics/homo_sapiens/genome/genome.bed"

    // Truvari parameters - relaxed for testing
    truvari_refdist = 1000
    truvari_pctsize = 0.5
    truvari_pctovl = 0
    truvari_pctseq = 0

    // Output configuration
    outdir = 'test_results_nfcore'
    run_name = 'nfcore_test'
}

// Process-specific overrides for testing
process {
    cpus   = { check_max( 1, 'cpus' ) }
    memory = { check_max( 2.GB, 'memory' ) }
    time   = { check_max( 2.h, 'time' ) }  // Increased for long-read callers
}
