/*
========================================================================================
    Nextflow config file for testing ONT SV callers
========================================================================================
    Tests CuteSV and Sniffles on Oxford Nanopore data using nf-core test datasets
----------------------------------------------------------------------------------------
*/

params {
    // Test configuration metadata
    config_profile_name        = 'ONT SV callers test profile'
    config_profile_description = 'Test dataset for ONT SV calling (CuteSV and Sniffles)'

    // Limit resources for testing
    max_cpus   = 2
    max_memory = '6.GB'
    max_time   = '6.h'

    // Base URL for nf-core test-datasets
    test_data_base = 'https://raw.githubusercontent.com/nf-core/test-datasets/modules/data'

    // Reference genome - chr22 subset
    fasta = "${test_data_base}/genomics/homo_sapiens/genome/genome.fasta"

    // Oxford Nanopore BAM file - using available test data
    // Note: nf-core test datasets have ONT BAM files in nanopore/ directory
    ont_bam = "${test_data_base}/genomics/homo_sapiens/nanopore/bam/test.sorted.bam"
    
    // Disable other technologies for this test
    illumina_wes_bam = null
    illumina_wgs_bam = null
    pacbio_bam = null

    // Skip benchmarking - no SV truth set available for test data
    benchmark_vcf = null
    skip_benchmarking = true

    // Target BED files - using minimal test regions
    high_confidence_targets = "${test_data_base}/genomics/homo_sapiens/genome/genome.bed"
    gene_panel_targets = "${test_data_base}/genomics/homo_sapiens/genome/genome.bed"
    wes_utr_targets = "${test_data_base}/genomics/homo_sapiens/genome/genome.bed"

    // Optional files - tandem repeats can improve Sniffles accuracy
    // Using a minimal test BED file as placeholder
    tandem_repeats = "${test_data_base}/genomics/homo_sapiens/genome/genome.bed"

    // CuteSV parameters - optimized for ONT
    // (These can be customized in modules.config if needed)

    // Sniffles parameters
    // (These can be customized in modules.config if needed)

    // Output configuration
    outdir = 'test_results_ont'
    run_name = 'ont_sv_test'
}

// Process-specific overrides for testing
process {
    cpus   = { check_max( 1, 'cpus' ) }
    memory = { check_max( 2.GB, 'memory' ) }
    time   = { check_max( 2.h, 'time' ) }
    
    // Allow processes to fail for testing purposes
    // This helps identify which callers work with the test data
    errorStrategy = 'ignore'
}
